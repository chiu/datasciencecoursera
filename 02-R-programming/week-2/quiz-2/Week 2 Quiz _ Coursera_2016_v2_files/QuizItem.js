define("bundles/ondemand/components/quiz/QuizItem",["require","exports","module","classnames","q","react-with-addons","bundles/assess/assessmentTypes/phoenixQuiz/assessment","bundles/assess/assessmentTypes/phoenixQuiz/assessment.attempt","bundles/content-feedback/constants/ItemTypes","bundles/ondemand/components/ItemLayout","bundles/ondemand/components/item/LightItemLayout","bundles/ondemand/utils/componentDataFetcher","bundles/ondemand/utils/itemViewValidator","bundles/phoenix/components/OrigamiRegion","pages/open-course/assessment/clients/contentRequesterAssessmentClient","pages/open-course/assessment/clients/naptimeAssessmentClient","pages/open-course/assessment/models/exam/assessment","pages/open-course/assessment/models/openSinglePage/assessment","pages/open-course/assessment/models/quiz/assessment","pages/open-course/common/contentRequester","pages/open-course/common/models/itemMetadata","pages/open-course/common/naptimeItemClient","pages/open-course/common/singletons/course","pages/open-course/common/singletons/courseGrade","pages/open-course/common/singletons/courseMaterials","pages/open-course/common/singletons/courseProgress","pages/open-course/common/singletons/verificationDisplay","pages/open-course/common/utils/lockExperiment","pages/open-course/verification/views/verification"],function(require,exports,module){"use strict";function getContentModelPromise(e){if("assessOpenSinglePage"===e.getTypeName())return y({metadata:e});if("quiz"===e.getTypeName())return f({metadata:e});if("exam"===e.getTypeName())return s({metadata:e})}function getClient(e){if("assessOpenSinglePage"===e.getTypeName()||"quiz"===e.getTypeName()){var s=new b(e);return new l(s)}if("exam"===e.getTypeName()){var t=new v(e);return new g(e,t)}}var t=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(n[t]=s[t])}return n},n=require("classnames"),o=require("q"),e=require("react-with-addons"),a=require("bundles/assess/assessmentTypes/phoenixQuiz/assessment"),i=require("bundles/assess/assessmentTypes/phoenixQuiz/assessment.attempt"),r=require("bundles/content-feedback/constants/ItemTypes"),m=require("bundles/ondemand/components/ItemLayout"),p=require("bundles/ondemand/components/item/LightItemLayout"),c=require("bundles/ondemand/utils/componentDataFetcher"),u=require("bundles/ondemand/utils/itemViewValidator"),d=require("bundles/phoenix/components/OrigamiRegion"),l=require("pages/open-course/assessment/clients/contentRequesterAssessmentClient"),g=require("pages/open-course/assessment/clients/naptimeAssessmentClient"),s=require("pages/open-course/assessment/models/exam/assessment"),y=require("pages/open-course/assessment/models/openSinglePage/assessment"),f=require("pages/open-course/assessment/models/quiz/assessment"),b=require("pages/open-course/common/contentRequester"),h=require("pages/open-course/common/models/itemMetadata"),v=require("pages/open-course/common/naptimeItemClient"),T=require("pages/open-course/common/singletons/course"),q=require("pages/open-course/common/singletons/courseGrade"),P=require("pages/open-course/common/singletons/courseMaterials"),w=require("pages/open-course/common/singletons/courseProgress"),x=require("pages/open-course/common/singletons/verificationDisplay"),I=require("pages/open-course/common/utils/lockExperiment"),C=require("pages/open-course/verification/views/verification"),M={start:a,verify:C,attempt:i},R=e.createClass({displayName:"QuizItem",propTypes:{itemMetadata:e.PropTypes.instanceOf(h).isRequired,isComponentLoaded:e.PropTypes.bool.isRequired,course:e.PropTypes.object.isRequired,courseProgress:e.PropTypes.object.isRequired,courseMaterials:e.PropTypes.object.isRequired,courseGrade:e.PropTypes.object.isRequired,verificationDisplay:e.PropTypes.object.isRequired,model:e.PropTypes.object.isRequired,nextItemMetadata:e.PropTypes.object.isRequired},getInitialState:function getInitialState(){return{state:"start",stateOptions:{}}},componentDidMount:function componentDidMount(){var e=this.props,s=e.course,t=e.courseMaterials,n=e.courseGrade,o=e.courseProgress;I.setup(s.get("id"),t,n,o)},onStateChange:function onStateChange(e,s){this.setState({state:e,stateOptions:s||{}})},renderView:function renderView(){var i=this.props.isComponentLoaded,o=this.state,s=o.state,r=o.stateOptions,a=M[s];if(!a)throw new Error("Unknown state: "+s);var m=n("rc-QuizItem",{state:s});return e.createElement("div",{className:m},i&&e.createElement(d,{ViewClass:a,viewOptions:t({},this.props,r,{onStateChange:this.onStateChange})}))},render:function render(){var t=this.props.itemMetadata,n=this.state.state,s=this.renderView();return"start"===n?e.createElement(m,null,e.createElement(p,{itemMetadata:t,itemType:r.Quiz,isCard:!0},s)):s}}),z=c(R,function(s,t){var e=s.itemMetadata;return o.all([getContentModelPromise(e),T,q,w,P,x]).spread(function(t,n,o,a,s,i){return{course:n,courseProgress:a,courseMaterials:s,courseGrade:o,verificationDisplay:i,assessmentClient:getClient(e),model:t,nextItemMetadata:s.getNeighboringItemMetadata(e).next}})});module.exports=u(z,{renderItemLayout:!0})});